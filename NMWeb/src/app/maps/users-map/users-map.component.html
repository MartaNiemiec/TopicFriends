
<!-- Quick "port" to PeopleMatcher codebase. No bootstrap though -->

<div class="container">
  <h1>
    Users Map
  </h1>
  <div
    class="row"
  >
    <div class="col-xs-12">
      <ng-template [ngIf]="false">
        <h2>This is your current location: </h2>
        <div *ngIf="coordinates">
          <p>Latitude: {{coordinates.latitude}}</p>
          <p>Longitude: {{coordinates.longitude}}</p>
        </div>
        <md-slider
          min="100"
          max="50000"
          step="200"
          tickInterval="3"
          [(ngModel)]="radiusSearch"
          (change)="onRadiusSearchChange()"
        ></md-slider>

        <p>There are <b>{{ numberOfNearUsers }}</b> map points within {{ radiusSearch | distance }}.</p>
      </ng-template>

      <div>
        <md-checkbox
          checked="showLabelsOverMarker"
          (change)="changeShowLabelOverMark()"
        >
          Show Labels &nbsp;
        </md-checkbox>
        <md-checkbox
          checked="showPeople"
          (change)="changeShowPeople()"
        >
          Show People
        </md-checkbox>
      </div>

    </div>
  </div>
  <p>There are currently {{allUsersGeoLocationsFlattened?.length}} points on the map</p>
  <div class="row">
    <div class="col-xs-12">
      <div *ngIf="coordinates">
        <agm-map
          [latitude]="coordinates.latitude"
          [longitude]="coordinates.longitude"
          [zoom]="10">

          <ng-template [ngIf]="showPeople">
            <ng-template ngFor let-userLocation [ngForOf]="allUsersGeoLocationsFlattened">
              <agm-marker
                [markerClickable]="true"
                (markerClick)="onMarkerClick(userLocation)"
                [latitude]="userLocation.latitude"
                [longitude]="userLocation.longitude"
                [label]="(showLabelsOverMarker ? userLocation.title : '' ) | async"
              ></agm-marker>
            </ng-template>
          </ng-template>

          <agm-marker
            *ngFor="let location of pois"
            [markerClickable]="true"
            [iconUrl]="'https://developers.google.com/maps/documentation/javascript/examples/full/images/beachflag.png'"
            (markerClick)="onMarkerClick(userLocation)"
            [latitude]="location.geoLocation.latitude"
            [longitude]="location.geoLocation.longitude"
            [label]="(showLabelsOverMarker ? location.title : '' )"
          ></agm-marker>

          <!--<agm-marker *ngFor="let userCoords of usersCoords"-->
            <!--[latitude]="userCoords.geoCoords.latitude"-->
            <!--[longitude]="userCoords.geoCoords.longitude"-->
            <!--[label]="userCoords.user.displayName"-->
            <!--&gt;-->
          <!--</agm-marker>-->

          <!--<agm-circle-->
            <!--[latitude]="coordinates.latitude"-->
            <!--[longitude]="coordinates.longitude"-->
            <!--[radius]="300"-->
            <!--fillColor="#4885ed"-->
          <!--&gt;</agm-circle>-->
        </agm-map>
      </div>
    </div>
  </div>
</div>

